# global options block
{
    # uncomment the line below to disable automatic HTTPS certificate fetching (for local testing)
    # auto_https off
}

# home
hackcation.dev {
    reverse_proxy home-site:80
}

# api subdomain
api.hackcation.dev {
    header {
        Access-Control-Allow-Origin "https://voter.hackcation.dev https://hackcation.dev"
        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Access-Control-Allow-Headers "Content-Type, Authorization"
        Access-Control-Allow-Credentials true
        Access-Control-Max-Age 3600
    }

    @options {
        method OPTIONS
    }
    respond @options 204

    reverse_proxy voter-http:8080
}

# voter app
voter.hackcation.dev {
    reverse_proxy voter-app:3000
}
